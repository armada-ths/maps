<!DOCTYPE html>

<html>
	<head>
		<title>Armada Maps</title>
		
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<style type="text/css">
			#map
			{
				background-color:rgba(255,0,0,0.0);
			}
		</style>
		
		<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
		<script src="/jquery-3.3.1.min.js"></script>
		<script>
			var map;
			
			$(function()
			{
				map = L.map('map',
				{
					crs: L.CRS.Simple,
					minZoom: -5
				});
				
				setup_maps();
			});
			
			
			var setup_maps = function()
			{
				$.get('//ais.armada.nu/api/exhibitors/locations', function(locations)
				{
					var i = 1;
					var desired = 2;
					
					for (var location of locations)
					{
						if (location.has_map)
						{
							if (i == desired) { setup_map(location.id); }
							i++;
						}
					}
				});
			};
			
			
			var setup_map = function(id)
			{
				$.get('//ais.armada.nu/api/exhibitors/locations/' + id, function(location)
				{
					console.log(location)
					
					var bounds = [[0,0], [location.map.height,location.map.width]];
					var image = L.imageOverlay('//ais.armada.nu/' + location.map.url, bounds).addTo(map);
					map.fitBounds(bounds);
					
					for (var booth of location.booths)
					{
						var boundaries_scaled = [];
						
						for (var boundary of booth.boundaries)
						{
							boundaries_scaled.push(L.latLng(location.map.height - (boundary[1] * location.map.height), boundary[0] * location.map.width));
						}
						
						L.polyline(boundaries_scaled).addTo(map);
					}
					
					//map.removeLayer(image);
				});
			}
		</script>
		
		<style>
			html, body
			{
				height: 100%;
				margin: 0;
			}
			
			#map
			{
				position: fixed;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
			}
		</style>
	</head>
	
	<body>
		<div id="map"></div>
	</body>
</html>
